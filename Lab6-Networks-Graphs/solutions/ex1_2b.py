M = M / col_sums[np.newaxis, :] #newaxis ensures the broadcasting is correct
M